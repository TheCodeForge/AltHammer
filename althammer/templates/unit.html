{% extends "_core_centered.html" %}

{% macro backside() %}
    {% if u.core_rules %}
    <p>CORE RULES: <span class="fw-bold">{{ ', '.join(u.core_rules | sort | keyword) | safe }}</span></p>
    {% endif %}
    {% if u.faction_rules %}
    <p>FACTION RULES: <span class="fw-bold">{{ ', '.join(u.faction_rules) }}</span></p>
    {% endif %}

    {% if u.unit_rules %}
    <p><span class="fw-bold">ABILITIES</span></p>
    <ul>
    {% for rule in u.unit_rules %}
      <li><span class="fw-bold">{{ rule['name'] }}</span> - {{ rule['text'] | markdown | safe }}</li>
    {% endfor %}
    </ul>
    {% endif %}

    {% if u.weapons | listcomp("ability") | any %}
    <p><span class="fw-bold">GEAR ABILITIES</span></p>
    <ul>
    {% for weapon in u.weapons if weapon.__dict__.get('ability') %}
      <li><span class="fw-bold">{{ weapon.name }}</span> - {{ weapon.ability | markdown | safe }}</li>
    {% endfor %}
    </ul>
    {% endif %}

    <p><span class="fw-bold">UNIT COMPOSITION</span></p>
    <ul>
      {% for entry in u.composition %}
      <li>{{ entry }}</li>
      {% endfor %}
    </ul>
    <p>Every model is equipped with: </p>
      <ul>
      {% for weapon in u.default_weapons %}
        <li>{{ weapon.name }}</li>
      {% endfor %}
      </ul>
    {% if u.replacement_gear %}
    <p>The following substitutions may be made: </p>
      <ul>
      {% for x in u.replacement_gear %}
        <li>{{ x }} may be replaced with{% if (u.replacement_gear[x] | length) > 1%} one of{% endif %}:</li>
        <ul>
          {% for y in u.replacement_gear[x] %}
          <li>{{ u.weapon(y).name }}</li>
          {% endfor %}
        </ul>
      {% endfor %}
      </ul>
    {% endif %}
{% endmacro %}


{% block pagecontent %}

<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">Home</a></li>
    <li class="breadcrumb-item"><a href="{{ u.faction.permalink }}">{{ u.faction.name }}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{{ u.name }}</li>
  </ol>
</nav>

<h1>{{ u.name }}</h1>

<div class="row">
  <div class="col col-12 col-xl-8">
    <div class="row g-0">
      <table class="table w-100">
        <!---
        <thead>
          <tr>
            <th scope="col" class="text-center">M</th>
            <th scope="col" class="text-center">T</th>
            <th scope="col" class="text-center">Sv</th>
            <th scope="col" class="text-center">HP</th>
            <th scope="col" class="text-center">Ld</th>
            <th scope="col" class="text-center">OC</th>
          </tr>
        </thead>
        <tr>
          <td class="text-center">{{ u.move }}"</td>
          <td class="text-center">{{ u.tough }}</td>
          <td class="text-center">{{ u.save }}+{% if u.__dict__.get("invuln") %}<i class="fas fa-shield-halved"></i>{{ u.invuln }}++{% endif %}</td>
          <td class="text-center">{{ u.hp }}</td>
          <td class="text-center">{{ u.lead }}+</td>
          <td class="text-center">{{ u.oc }}</td>
        </tr>
      -->
      <tr></tr>
        <thead>
          <tr>
            <th scope="col" class="text-center align-top"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Movement"><i class="fas fa-fw fa-person-running"></i> {{ u.move }}"</span></th>
            <th scope="col" class="text-center align-top"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Toughness"><i class="fas fa-fw fa-block-brick"></i> {{ u.tough }}</span></th>
            <th scope="col" class="text-center align-top"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Armor Save"><i class="fas fa-fw fa-shield"></i> {{ u.save }}+</span>{% if u.__dict__.get("invuln") %}<br><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Invulnerable Save"><i class="fas fa-shield-plus"></i> {{ u.invuln }}+</span>{% endif %}</th>
            <th scope="col" class="text-center align-top"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Health"><i class="fas fa-fw fa-heart"></i> {{ u.hp }}</span></th>
            <th scope="col" class="text-center align-top"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Leadership"><i class="fas fa-fw fa-flag"></i> {{ u.lead }}+</span></th>
            <th scope="col" class="text-center align-top"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Objective Control"><i class="fas fa-fw fa-bullseye"></i> {{ u.oc }}</span></th>
          </tr>
        </thead>
      </table>

      <table class="table w-100">
        <tr></tr>
        {% if u.ranged_weapons %}
        <thead>
          <tr>
            <th scope="col">Ranged Weapons</th>
            <th scope="col" class="text-center"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Range"><i class="fas fa-fw fa-ruler"></i></span></th>
            <th scope="col" class="text-center"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Attacks"><i class="fas fa-fw fa-swords"></i></span></th>
            <th scope="col" class="text-center"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Ranged Skill"><i class="fas fa-fw fa-gun"></i></th>
            <th scope="col" class="text-center"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Strength"><i class="fas fa-fw fa-hand-fist"></i></span></th>
            <th scope="col" class="text-center"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Armor Break"><i class="fas fa-fw fa-bone-break"></i></span></th>
            <th scope="col" class="text-center"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Damage"><i class="fas fa-fw fa-droplet"></i></span></th>
          </tr>
        </thead>
        {% for weapon in u.ranged_weapons %}
        <tr>
          <td>{{ weapon.name }}{% if weapon.keywords %} <span class="keyword">[{{ ", ".join(weapon.keywords | sort | keyword) | safe }}]</span>{% endif %}</td>
          <td class="text-center">{{ weapon.rng }}"</td>
          <td class="text-center text-nowrap">{{ weapon.atk }}</td>
          <td class="text-center">{{ weapon.skl or '-' }}</td>
          <td class="text-center">{{ weapon.str }}</td>
          <td class="text-center">-{{ weapon.ap }}</td>
          <td class="text-center text-nowrap">{{ weapon.dmg }}</td>
        </tr>
        {% endfor %}

        {% endif %}
        <thead>
          <tr>
            <th scope="col">Melee Weapons</th>
            <th scope="col" class="text-center"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Range"><i class="fas fa-fw fa-ruler"></i></span></th>
            <th scope="col" class="text-center"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Attacks"><i class="fas fa-fw fa-swords"></i></span></th>
            <th scope="col" class="text-center"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Melee Skill"><i class="fas fa-fw fa-sword"></i></th>
            <th scope="col" class="text-center"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Strength"><i class="fas fa-fw fa-hand-fist"></i></span></th>
            <th scope="col" class="text-center"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Armor Break"><i class="fas fa-fw fa-bone-break"></i></span></th>
            <th scope="col" class="text-center"><span type="button" class="text-nowrap" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-trigger="click hover focus" data-bs-content="Damage"><i class="fas fa-fw fa-droplet"></i></span></th>
          </tr>
        </thead>
        {% for weapon in u.melee_weapons %}
        <tr>
          <td>{{ weapon.name }}{% if weapon.keywords %} <span class="keyword">[{{ ", ".join(weapon.keywords | sort | keyword) | safe }}]</span>{% endif %}</td>
          <td class="text-center">Melee</td>
          <td class="text-center text-nowrap">{{ weapon.atk }}</td>
          <td class="text-center">{{ weapon.skl or '-' }}</td>
          <td class="text-center">{{ weapon.str }}</td>
          <td class="text-center">-{{ weapon.ap }}</td>
          <td class="text-center text-nowrap">{{ weapon.dmg }}</td>
        </tr>
        {% endfor %}
      </table>
    </div>
    <div class="row">
      <div class="col col-8">
        <p>KEYWORDS: <span class="keyword">{{ ', '.join(u.keywords | sort) }}</span></p>
      </div>
      <div class="col col-4">
        <p>FACTION: <span class="keyword">{{ ', '.join(u.faction_keywords) }}</span></p>
      </div>
    </div>
    <div class="row d-block d-xl-none">
      <div class="col col-12">
        {{ backside() }}
      </div>
    </div>
  </div>
  <div class="col col-4 d-none d-xl-block g-0">
    {{ backside() }}
  </div>
</div>

{% endblock %}
